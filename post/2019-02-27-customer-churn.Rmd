---
title: Customer Churn
author: Andrew Chiu
date: '2019-02-27'
slug: customer-churn
categories: []
tags: [churn]
image: ''
showonlyimage: no
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = TRUE, message = FALSE, warning = FALSE)
```

## Introduction

Customer retention continues to be a problem for businesses.

```{r, echo = FALSE}
library(dplyr)
library(ggplot2)
```


## The data

The data in this piece was downloaded from [IBM Sample Data Sets](https://www.ibm.com/communities/analytics/watson-analytics-blog/guide-to-sample-datasets/).

```{r}
url <- "https://community.watsonanalytics.com/wp-content/uploads/2015/03/WA_Fn-UseC_-Telco-Customer-Churn.csv?cm_mc_uid=10924880594715512438678&cm_mc_sid_50200000=61751631551243867866&cm_mc_sid_52640000=17392971551243867874"

data <- read.csv(file = url)

glimpse(data)
```

For me, one of the most important things is to ensure that the data is as clean
as practicable, to ensure a smoother downstream analysis.

From the glimpse of the data above, it's clear that the variable *SeniorCitizen*
is different from other factor variables, in that most have the human-readable
"yes" or "no" value, while this one is a 1 or 0.

This is easily converted to a "yes" or "no" by mapping the 0s to "no", 
and 1s to "yes", and turning it into a factor variable. The benefit of 
converting these to factor variables is that it is easily converted back to an
integer.

```{r}
data$SeniorCitizen <- ifelse(data$SeniorCitizen == 0, "No", "Yes")
data$SeniorCitizen <- as.factor(data$SeniorCitizen)
```

## Exploring the data

What we're interested in is the *Churn* variable.

```{r echo = FALSE, fig.width = 10, fig.height = 3}
ggplot(data = data,
       aes(x = Churn, fill = Churn)) +
  geom_bar(show.legend = FALSE) +
  scale_fill_manual(values = c("#112F41", "#47AB6C")) +
  theme_minimal() +
  theme(panel.grid = element_blank()) +
  labs(x = "Churn", y = "", title = "Distribution of Churn")

```

Knowledge of the retail industry tells me that older people are less likely to
deviate from the status quo. The *SeniorCitizen* variable will help to determine
whether this intuition is correct.

```{r,echo = FALSE, fig.width = 10, fig.height = 4}
ggplot(data = data,
       aes(x = SeniorCitizen, fill = Churn)) +
  geom_bar(position = "dodge") +
  scale_fill_manual(values = c("#112F41", "#47AB6C")) +
  theme_minimal() +
  theme(panel.grid = element_blank()) +
  labs(x = "Senior Citizen", y = "", title = "Distribution of Churn")
```

But even amongst non senior citizens, there are customers at different stages in
life, such as:

* Individuals
* Dual Incomes, No Kinds (DINKS)
* Married, with dependents

Maybe we can tease this information out through the following variables:

* Partner
* Dependents
* SeniorCitizen

```{r}
data %>%
  filter(SeniorCitizen == "No") %>%
  group_by(Partner) %>%
  count(Dependents) %>%
  mutate(proportions = n / sum(n))
```

